CREATE TABLE IF NOT EXISTS `prevenda` (
	`EMPRESA` INT(11) NOT NULL DEFAULT '0',
	`VENDA` INT(11) NOT NULL DEFAULT '0',
	`TIPOVENDA` VARCHAR(15) NOT NULL DEFAULT '' COLLATE 'latin1_swedish_ci',
	`CODIGOCLI` INT(11) NOT NULL DEFAULT '0',
	`NOMECLI` VARCHAR(50) NOT NULL DEFAULT '' COLLATE 'latin1_swedish_ci',
	`ENDERCLI` VARCHAR(50) NOT NULL DEFAULT '' COLLATE 'latin1_swedish_ci',
	`BAIRROCLI` VARCHAR(30) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CIDADECLI` VARCHAR(30) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ESTADOCLI` CHAR(2) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CEPCLI` VARCHAR(10) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`FONECLI` VARCHAR(14) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`VLR_DESCONTO` DECIMAL(15,2) NOT NULL DEFAULT '0.00',
	`VLRTOTAL` DECIMAL(15,2) NULL DEFAULT NULL,
	`CPFCGC` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`IDENINSC` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`APROVADO` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DATAAPROV` DATE NULL DEFAULT NULL,
	`TIPOAPROV` VARCHAR(10) NOT NULL DEFAULT '' COLLATE 'latin1_swedish_ci',
	`SITUACAO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`EMISSAO` DATE NULL DEFAULT NULL,
	`OBSERVACAO` BLOB NULL DEFAULT NULL,
	`FORMAPAGTO` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ID_VENDEDOR` INT(11) NULL DEFAULT NULL,
	`STATUS` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ID_PLANOPGTO` INT(11) NULL DEFAULT NULL,
	`ID_FORMAPGTO` INT(11) NULL DEFAULT NULL,
	`ID_TIPOPEDIDO` INT(11) NULL DEFAULT NULL,
	`CANCELADO` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ENTRADA` CHAR(1) NOT NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`VALOR_ENTRADA` DECIMAL(15,2) NULL DEFAULT NULL,
	`ENTRADA_PAGA` CHAR(1) NOT NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`DATA_ENTRADA` DATE NULL DEFAULT NULL,
	`OUTRO_DESC` DECIMAL(15,2) NULL DEFAULT '0.00',
	`OUTRO_DESC_ORIGINAL` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Campo criado para recuperar o desconto inicial, esse campo sera usado para substituir o valor do campo OUTRO_DESC ao cancelar um pedido',
	`ACRESCIMO` DECIMAL(15,2) NULL DEFAULT '0.00',
	`ACRESCIMO_ORIGINAL` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Campo criado para recuperar o acrescimo inicial, esse campo sera usado para substituir o valor do campo ACRESCIMO ao cancelar um pedido',
	`ID_PREVENDA` INT(11) NULL DEFAULT NULL,
	`ID_DAV` INT(11) NULL DEFAULT NULL,
	`CAIXA` INT(11) NULL DEFAULT NULL,
	`CUPOM` INT(11) NULL DEFAULT NULL,
	`STATUSPAF` CHAR(1) NULL DEFAULT 'I' COLLATE 'latin1_swedish_ci',
	`SELECIONADO` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ID_DAVSTR` VARCHAR(10) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ID_PREVENDASTR` VARCHAR(10) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`NOTA` INT(11) NULL DEFAULT NULL,
	`SERIE` INT(11) NULL DEFAULT NULL,
	`NOTAIMPRESSA` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`BASEDECALCULO` DECIMAL(15,2) NULL DEFAULT '0.00',
	`VALORICMS` DECIMAL(15,2) NULL DEFAULT '0.00',
	`BASEST` DECIMAL(15,2) NULL DEFAULT '0.00',
	`VALORICMSST` DECIMAL(15,2) NULL DEFAULT '0.00',
	`TOTALSERVICOS` DECIMAL(15,2) NULL DEFAULT NULL,
	`VALORFRETE` DECIMAL(15,2) NULL DEFAULT NULL,
	`VALORSEGURO` DECIMAL(15,2) NULL DEFAULT NULL,
	`VALORDESPESAS` DECIMAL(15,2) NULL DEFAULT NULL,
	`VALORIPI` DECIMAL(15,2) NULL DEFAULT NULL,
	`ID_TRANSPORTADOR` INT(11) NULL DEFAULT NULL,
	`PLACA` VARCHAR(8) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`FRETEPORCONTA` INT(11) NULL DEFAULT NULL,
	`QUANTIDADE` DECIMAL(15,3) NULL DEFAULT NULL,
	`ESPECIE` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`MARCA` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`PESOBRUTO` DECIMAL(15,3) NULL DEFAULT NULL,
	`PESOLIQUIDO` DECIMAL(15,3) NULL DEFAULT NULL,
	`VALORISS` DECIMAL(15,2) NULL DEFAULT NULL,
	`ALIQUOTAISS` DECIMAL(15,2) NULL DEFAULT NULL,
	`BASEISS` DECIMAL(15,3) NULL DEFAULT NULL,
	`CARIMBO` BLOB NULL DEFAULT NULL,
	`INFOADICIONAL` BLOB NULL DEFAULT NULL,
	`FATURAMENTOIMPRESSO` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DATAENTREGA` DATE NULL DEFAULT NULL,
	`DATAGERACAONF` DATE NULL DEFAULT NULL,
	`ID_AUTORIZADO` INT(11) NULL DEFAULT NULL,
	`ID_USUARIOCADASTRO` INT(11) NULL DEFAULT NULL,
	`DEVOLVIDO` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DATADEVOLUCAO` DATE NULL DEFAULT NULL,
	`NFDEVOLUCAO` INT(11) NULL DEFAULT NULL,
	`SERIEDEVOLUCAO` INT(11) NULL DEFAULT NULL,
	`ENTREGAR` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`LOCALENTREGADIF` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ENDERECOENTREGA` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`BAIRROENTREGA` VARCHAR(30) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CIDADEENTREGA` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ESTADOENTREGA` CHAR(2) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CEPENTREGA` VARCHAR(10) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`TELEFONEENTREGA` VARCHAR(18) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CONTATOENTREGA` VARCHAR(30) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CCF` INT(11) NULL DEFAULT NULL,
	`ID_PEDIDOPALM` INT(11) NULL DEFAULT NULL,
	`DATA_VISITA` DATETIME NULL DEFAULT NULL,
	`ENTREGUE` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`DTRECEBIMENTOENTREGA` DATE NULL DEFAULT NULL,
	`HORARECEBIMENTOENTREGA` TIME NULL DEFAULT NULL,
	`OBSERVACAO_ENTREGA` BLOB NULL DEFAULT NULL,
	`ID_VENDEDOR_EXTERNO` INT(11) NULL DEFAULT NULL,
	`RETIRADOPOR` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`HORA` TIME NULL DEFAULT NULL,
	`MD5` BLOB NULL DEFAULT NULL,
	`BASEPIS` DECIMAL(15,2) NULL DEFAULT NULL,
	`VL_PIS` DECIMAL(15,2) NULL DEFAULT NULL,
	`BASECOFINS` DECIMAL(15,2) NULL DEFAULT NULL,
	`VL_COFINS` DECIMAL(15,2) NULL DEFAULT NULL,
	`IMPRESSO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`PARTICIPAPISCOFINS` CHAR(1) NULL DEFAULT 'S' COLLATE 'latin1_swedish_ci',
	`IDROMANEIO` INT(11) NULL DEFAULT NULL,
	`UF` CHAR(2) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`VL_PIS_ST` DECIMAL(15,2) NULL DEFAULT '0.00',
	`VL_COFINS_ST` DECIMAL(15,2) NULL DEFAULT '0.00',
	`RECEBIDO` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DTRECEBIMENTO` DATE NULL DEFAULT NULL,
	`RECEBIMENTOOK` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ID_PEDIDOCOMPRA` VARCHAR(255) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`VALIDADE_ORCAMENTO` DATE NULL DEFAULT NULL,
	`ID_PROFISSIONAL` INT(11) NULL DEFAULT NULL,
	`ID_ROTA` INT(11) NULL DEFAULT NULL,
	`LIBERADO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`USUARIO_LIBERACAO` INT(11) NULL DEFAULT NULL,
	`DATA_LIBERACAO` DATETIME NULL DEFAULT NULL,
	`FRETE` DECIMAL(15,2) NULL DEFAULT '0.00',
	`USUARIOGERENCIA` INT(11) NULL DEFAULT NULL,
	`LIBERADOGERENCIA` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`DATALIBERACAOGERENCIA` DATE NULL DEFAULT NULL,
	`SIMPLES_REMESSA` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`ID_ADM` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`EDITADOGERENCIA` CHAR(1) NOT NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`SALDODC` DECIMAL(15,2) NULL DEFAULT '0.00',
	`STATUS_CAIXA_OPERADOR` CHAR(1) NULL DEFAULT 'X' COLLATE 'latin1_swedish_ci',
	`SOLUCAO_PENDENCIA` VARCHAR(255) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ID_USUARIO_CAIXA_OPERADOR` INT(11) NULL DEFAULT NULL,
	`SELECAO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`CORPORATIVO` CHAR(1) NOT NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`ID_CARIMBO_OBS` INT(11) NULL DEFAULT NULL COMMENT 'Carimbo do pedido',
	`ID_CARIMBO_ADICIONAIS` INT(11) NULL DEFAULT NULL COMMENT 'Carimbo do pedido infomacoes adicionais',
	`ID_CARIMBO` INT(11) NULL DEFAULT NULL,
	`DATA_TRANSACAO` DATE NULL DEFAULT NULL,
	`ID_FORMAPGTO_ENTRADA` INT(11) NULL DEFAULT NULL,
	`ID_ADM_ENTRADA` VARCHAR(20) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`NUMDOC_ENTRADA` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`NUM_PARCELAS_ENTRADA` INT(11) NULL DEFAULT NULL,
	`TIPO_ENTRADA` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ID_PLANOCONTA` INT(11) NULL DEFAULT '0',
	`VFCP_TOT` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Grupo W. Total da NF-e , NT_2016_002 v130 -> Corresponde ao total da soma dos campos id: N17c  ',
	`VFCPUFDEST_TOT` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Pertence ao GRUPO ICMSTot NT_2015_003 v194 -> NT2016_002 v130 -- Valor total do ICMS relativo ao Fundo de Combate a Pobreza(FCP) para a UF de destino',
	`VICMSUFDEST_TOT` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Pertence ao GRUPO ICMSTot NT_2015_003 v194 -> NT2016_002 v130 --Valor total do ICMS Interestadual para a UF de destino. *Valor total do ICMS Interestadual para a UF de destino (sem o valor do ICMS relativo ao FCP).',
	`VICMSUFREMET_TOT` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Pertence ao GRUPO ICMSTot NT_2015_003 v194 -> NT2016_002 v130 -> Valor total do ICMS Interestadual para a UF do remetente. *Valor total do ICMS Interestadual para a UF do remetente. Nota: A partir de 2019, este valor sera zero ',
	`VFCPST_TOT` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor total do FCP ST',
	`VFCPSTRET_TOT` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'valor total do FCP ST RET',
	`ID_MEIO_PGTO_CAB` INT(11) NULL DEFAULT NULL COMMENT 'Este campo faz referencia ao meio de pagamento ligado a este registro do pedido',
	`INDICADOR_PRESENCA` INT(11) NULL DEFAULT NULL COMMENT 'Este campo guarda a  tag indicador de presenca  do comprador para NFe',
	`IDDEST` INT(11) NULL DEFAULT NULL COMMENT '1 = Interna / 2 = interestadual / 3 = exterior',
	`BASE_IPI` DECIMAL(15,2) NULL DEFAULT '0.00',
	`CONSUMO_FINAL` CHAR(1) NOT NULL DEFAULT 'N' COMMENT 'Indica se a venda sera para consumo final' COLLATE 'latin1_swedish_ci',
	`DESTINO_DEMONSTRACAO` INT(11) NULL DEFAULT NULL COMMENT 'Quando operação de demonstração 1 - Dentro do Estado, 2- Fora do Estado',
	`ACRESCIMO_PROMOCIONAL_PL_PGTO` DECIMAL(15,3) NULL DEFAULT NULL COMMENT 'Define o acrescimo para itens promocionais, de acordo com o  plano de pagamento ',
	`ACRESCIMO_PL_PGTO` DECIMAL(15,3) NULL DEFAULT NULL COMMENT 'Define o acrescimo para os itens, de acordo com o  plano de pagamento ',
	`VICMSDESON_TOT` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Abatimento nao tributado e nao comercial Ex. desconto ICMS nas remessas para ZFM',
	`INCIDE_IPI_BC_ICMS` CHAR(1) NOT NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`DESCONTAR_DESONERADO` CHAR(1) NOT NULL DEFAULT 'N' COMMENT 'descontar ICMS desonerado' COLLATE 'latin1_swedish_ci',
	`ID_USUARIO_EDICAO` INT(11) NULL DEFAULT NULL COMMENT 'Cod. do usuario que alterou o pedido',
	`NFCE` INT(11) NOT NULL DEFAULT '0',
	`PLANO_ALTERADO` CHAR(1) NOT NULL DEFAULT 'N' COMMENT 'Indica se o plano de pgto foi alterado' COLLATE 'latin1_swedish_ci',
	`TEXTO_COMP_OBS` BLOB NULL DEFAULT NULL COMMENT 'Informacoes complementares da nota',
	`STATUS_APROVACAO` INT(11) NOT NULL DEFAULT '1' COMMENT '1 = Aguardando aprov / 2 = Pre aprovado / 3 = Finalizado',
	`GPS_LONGITUDE` VARCHAR(60) NULL DEFAULT NULL COMMENT 'Longitude do momento em que foi feito o pedido' COLLATE 'latin1_swedish_ci',
	`GPS_LATITUDE` VARCHAR(60) NULL DEFAULT NULL COMMENT 'Latitude do momento em que foi feito o pedido' COLLATE 'latin1_swedish_ci',
	`ADM_ECOMMERCE` VARCHAR(255) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`PARCELAS_ECOMMERCE` INT(11) NULL DEFAULT '0',
	`PEDIDO_EXPOSICAO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`DESPESAS_BOLETO` DECIMAL(15,2) NOT NULL DEFAULT '0.00',
	`ID_INTERMEDIADOR` INT(11) NULL DEFAULT NULL,
	`VLR_ENTREGA_ECOMMERCE` DECIMAL(15,3) NULL DEFAULT NULL COMMENT 'Referente ao valor pago pela empresa do frete',
	`VLR_MEIO_PGTO_ECOMMERCE` DECIMAL(15,3) NULL DEFAULT NULL COMMENT 'Referente as taxas de pagamento',
	`VLR_COMISSAO_ECOMMERCE` DECIMAL(15,3) NULL DEFAULT NULL COMMENT 'Referente a comissao paga pela empresa',
	`ID_PEDIDO_ORIGEM` INT(11) NOT NULL DEFAULT '0' COMMENT 'ID do pedido de compromisso de compra e venda que gerou a entrega parcial',
	`ID_PEDIDO_ECOMMERCE` VARCHAR(60) NULL DEFAULT '0' COMMENT 'ID referente ao pedido ecommerce' COLLATE 'latin1_swedish_ci',
	`TIPO_ECOMMERCE` INT(11) NULL DEFAULT '0' COMMENT 'ID referente ao tipo do ecommerce',
	`ID_VENDA_PDV_ECOMMERCE` INT(11) NOT NULL DEFAULT '0' COMMENT 'ID referente ao pedido do ifood merchant',
	`ORCAMENTO_PDV` CHAR(1) NOT NULL DEFAULT 'N' COMMENT 'Indica se o PDV permite Or?amento' COLLATE 'latin1_swedish_ci',
	`VALORCONTRATO` DECIMAL(15,2) NOT NULL DEFAULT '0.00',
	`ID_CONFERENCIA` INT(11) NOT NULL DEFAULT '0' COMMENT 'Codigo da conferencia de expedicao realizada para este pedido',
	PRIMARY KEY (`EMPRESA`, `VENDA`) USING BTREE,
	UNIQUE INDEX `UNK_EMPRESA_IDVENDEDOR_IDPEDIDOPALM` (`EMPRESA`, `ID_VENDEDOR`, `ID_PEDIDOPALM`) USING BTREE,
	INDEX `IDX_CODIGOCLI` (`CODIGOCLI`) USING BTREE,
	INDEX `IDX_EMPRESA` (`EMPRESA`) USING BTREE,
	INDEX `IDX_VENDA` (`VENDA`) USING BTREE,
	INDEX `IDX_CAIXA` (`CAIXA`) USING BTREE,
	INDEX `IDX_IDVENDEDOR` (`ID_VENDEDOR`) USING BTREE,
	INDEX `IDX_IDPREVENDA` (`ID_PREVENDA`) USING BTREE,
	INDEX `IDX_IDDAV` (`ID_DAV`) USING BTREE,
	INDEX `IDX_IDVENDEDOREXTERNO` (`ID_VENDEDOR_EXTERNO`) USING BTREE,
	INDEX `IDX_IDPLANOPGTO` (`ID_PLANOPGTO`) USING BTREE,
	INDEX `IDX_IDFORMAPGTO` (`ID_FORMAPGTO`) USING BTREE,
	INDEX `IDX_IDTIPOPEDIDO` (`ID_TIPOPEDIDO`) USING BTREE,
	INDEX `IDX_IDUSUARIOCADASTRO` (`ID_USUARIOCADASTRO`) USING BTREE,
	INDEX `IDX_IDPEDIDOCOMPRA` (`ID_PEDIDOCOMPRA`) USING BTREE,
	INDEX `IDX_IDPROFISSIONAL` (`ID_PROFISSIONAL`) USING BTREE,
	INDEX `IDX_IDROTA` (`ID_ROTA`) USING BTREE,
	INDEX `IDX_USUARIOLIBERACAO` (`USUARIO_LIBERACAO`) USING BTREE,
	INDEX `IDX_NOTA` (`NOTA`) USING BTREE,
	INDEX `IDX_SERIE` (`SERIE`) USING BTREE,
	INDEX `IDX_EMISSAO` (`EMISSAO`) USING BTREE,
	INDEX `IDX_CUPOM` (`CUPOM`) USING BTREE,
	INDEX `IDX_IDROMANEIO` (`IDROMANEIO`) USING BTREE,
	INDEX `NFCE` (`NFCE`) USING BTREE,
	CONSTRAINT `FK_Prevenda_1` FOREIGN KEY (`EMPRESA`) REFERENCES `empresas` (`CODIGO_N`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_2` FOREIGN KEY (`ID_PROFISSIONAL`) REFERENCES `profissionais` (`ID_PROFISSIONAL`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_3` FOREIGN KEY (`CODIGOCLI`) REFERENCES `clientes` (`CODIGOCLI`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_4` FOREIGN KEY (`ID_PLANOPGTO`) REFERENCES `planospgto` (`ID`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_5` FOREIGN KEY (`ID_FORMAPGTO`) REFERENCES `formaspgto` (`ID`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_6` FOREIGN KEY (`ID_TIPOPEDIDO`) REFERENCES `tipospedido` (`ID_TIPOPEDIDO`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_7` FOREIGN KEY (`ID_USUARIOCADASTRO`) REFERENCES `funcionarios` (`CODIGO`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_8` FOREIGN KEY (`USUARIO_LIBERACAO`) REFERENCES `funcionarios` (`CODIGO`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_Prevenda_9` FOREIGN KEY (`ID_VENDEDOR_EXTERNO`) REFERENCES `vendedores` (`ID_VENDEDOR`) ON UPDATE CASCADE ON DELETE RESTRICT
)
COLLATE='latin1_swedish_ci'
ENGINE=InnoDB
;




CREATE TABLE IF NOT EXISTS `produtos_prevenda` (
	`PRIMARIA` INT(11) NOT NULL AUTO_INCREMENT,
	`EMPRESA` INT(11) NOT NULL DEFAULT '0',
	`VENDA` INT(11) NOT NULL DEFAULT '0',
	`CODIGO` VARCHAR(14) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DESCRICAO` VARCHAR(60) NOT NULL DEFAULT '' COLLATE 'latin1_swedish_ci',
	`UNIDADE` CHAR(2) NOT NULL DEFAULT '' COLLATE 'latin1_swedish_ci',
	`QTDE` DECIMAL(15,3) NOT NULL DEFAULT '0.000',
	`UNITARIO` DECIMAL(15,3) NOT NULL DEFAULT '0.000',
	`ALIQUOTA` INT(11) NOT NULL DEFAULT '0',
	`CUSTO` DECIMAL(15,2) NOT NULL DEFAULT '0.00',
	`ID_PRODUTO` INT(11) NOT NULL DEFAULT '0',
	`TOT_ITEM` DECIMAL(15,2) NULL DEFAULT NULL,
	`DESCONTO` DECIMAL(15,2) NULL DEFAULT NULL,
	`TOTALDESCONTO` DECIMAL(15,2) NOT NULL DEFAULT '0.00',
	`DESC_RATEIO` DECIMAL(15,2) NULL DEFAULT NULL,
	`ENCARGO_RATEIO` DECIMAL(15,2) NULL DEFAULT NULL,
	`PRECOVENDA` DECIMAL(15,3) NULL DEFAULT NULL,
	`PESOLIQUIDO` DECIMAL(15,3) NULL DEFAULT NULL,
	`PESOBRUTO` DECIMAL(15,3) NULL DEFAULT NULL,
	`COMISSAO` DECIMAL(15,3) NULL DEFAULT NULL,
	`INFOADICIONAL` VARCHAR(100) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DADOADICIONAL` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CFOP` VARCHAR(5) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`BASEDECALCULO` DECIMAL(15,2) NULL DEFAULT NULL,
	`ALIQUOTAICMS` DECIMAL(15,2) NULL DEFAULT NULL,
	`VALORICMS` DECIMAL(15,2) NULL DEFAULT NULL,
	`CST` CHAR(3) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`FATURADO` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`VALORIPI` DECIMAL(15,2) NULL DEFAULT NULL,
	`DIFEUNITARIOVENDA` DECIMAL(15,2) NULL DEFAULT '0.00',
	`IMPOSTO` DECIMAL(15,2) NULL DEFAULT NULL,
	`CONFERIDO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`TOTALBRUTO` DECIMAL(15,2) NULL DEFAULT NULL,
	`DEVOLVIDO` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CUSTOREAL` DECIMAL(15,3) NULL DEFAULT NULL,
	`CUSTOOPERACIONAL` DECIMAL(15,3) NULL DEFAULT NULL,
	`PRECO_CONCORRENTE` DECIMAL(15,2) NULL DEFAULT '0.00',
	`MD5` BLOB NULL DEFAULT NULL,
	`CANCELADO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`BASEPIS` DECIMAL(15,2) NULL DEFAULT NULL,
	`ALIQUOTAPIS` DECIMAL(15,2) NULL DEFAULT NULL,
	`VL_PIS` DECIMAL(15,2) NULL DEFAULT NULL,
	`BASECOFINS` DECIMAL(15,2) NULL DEFAULT NULL,
	`ALIQUOTACOFINS` DECIMAL(15,2) NULL DEFAULT NULL,
	`VL_COFINS` DECIMAL(15,2) NULL DEFAULT NULL,
	`ALIQ_ECF` INT(11) NULL DEFAULT NULL,
	`ID_DAV` INT(11) NULL DEFAULT NULL,
	`NUMERO_ITEM` INT(11) NULL DEFAULT NULL,
	`EMISSAO` DATE NULL DEFAULT NULL,
	`CST_PIS` CHAR(2) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`CST_COFINS` CHAR(2) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`SIT_TRIBUTARIA` CHAR(1) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`QTD_DEVOLVIDA` DECIMAL(15,3) NOT NULL DEFAULT '0.000',
	`MARKUP` DECIMAL(15,2) NULL DEFAULT NULL,
	`PRECOINICIAL` DECIMAL(15,3) NOT NULL DEFAULT '0.000',
	`SALDO_PRODUTO` DECIMAL(15,3) NOT NULL DEFAULT '0.000',
	`ID_TONALIDADE` INT(11) NULL DEFAULT NULL,
	`PRODUTO_PROMOCAO` CHAR(1) NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`FRETE_RATEIO` DECIMAL(15,2) NULL DEFAULT NULL,
	`ACRESCIMO` DECIMAL(15,2) NOT NULL DEFAULT '0.00',
	`EDITADOGERENCIA` CHAR(1) NOT NULL DEFAULT 'N' COLLATE 'latin1_swedish_ci',
	`UNITARIOBASE` DECIMAL(15,3) NULL DEFAULT '0.000' COMMENT 'ESTE CAMPO REFERECE AL VALOR QUE FOI UTILIZADO COMO PREÇO BASE DO PRODUTO ANTERIORMENTE AOS DESCONTOS E ACRECIMOS REFERENTES A PLANOS PGTO E CLIENTES ESPECIAIS.',
	`CSOSN` CHAR(3) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ORIGEM_PRODUTO` INT(11) NULL DEFAULT NULL COMMENT 'Esse campo armazenara o codigo de origem para camposicao do CST/CSOSN',
	`PROTOCOLO_ENTRE_ESTADOS` CHAR(1) NULL DEFAULT NULL COMMENT 'Campo para armazenar  se há protocolo entre estados em operacoes interestaduais' COLLATE 'latin1_swedish_ci',
	`VBCFCPUFDEST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da BC FCP na UF de destino',
	`VBCUFDEST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da BC do ICMS na UF de destino',
	`PFCPUFDEST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da BC do ICMS na UF de destino',
	`PICMSUFDEST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Aliquota interna da UF de destino',
	`PICMSINTER` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Aliquota interestadual das UF envolvidas',
	`PICMSINTERPART` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Percentual provisorio de partilha do ICMS Interestadual ',
	`VFCPUFDEST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor do ICMS relativo ao Fundo de Combate a Pobreza (FCP) da UF de destino',
	`VICMSUFDEST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor total do ICMS Interestadual para a UF de destino.',
	`VICMSUFREMET` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor total do ICMS Interestadual para a UF do remetente.',
	`VBCFCPST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da base de calculo do FCP retido por Substituicao Tributaria',
	`PFCPST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Percentual do Fundo de Combate a Pobreza (FCP) retido por Substituicao Tributaria ',
	`VFCPST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor do FCP retido por Substituicao Tributaria',
	`VBCFCPSTRET` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da Base de Calculo do FCP retido anteriormente',
	`PFCPSTRET` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Percentual do FCP retido anteriormente por Substituicao Tributaria',
	`VFCPSTRET` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor do FCP retido anteriormente por Substituicao Tributaria',
	`VFCP` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor do Fundo de Combate a Pobreza (FCP)',
	`PFCP` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Percentual do Fundo de Combate a Pobreza (FCP)',
	`VBCFCP` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da base de calculo do FCP -> Informa o valor da base de calculo do FCP.',
	`REDUCAO` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da Reducao da base de calculo do ICMS',
	`BASESUBSTITUICAO` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da base de calculo do ICMS ST',
	`ICMSST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor do ICMS ST',
	`REDUCAOST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da Reducao da base de calculo do ICMS ST',
	`MVA` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor do mva usado no calculo do ICMS ST',
	`ALIQUOTAINTERNA_DEST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da aliq. interna destinatario usado no calculo do ICMS ST',
	`vBCSTRet` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor da BC do ICMS ST cobrado anteriormente por ST (CST 060)',
	`vICMSSTRet` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Valor do ICMS ST cobrado anteriormente por ST (CST 060)',
	`pST` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Deve ser informada a aliquota do calculo do ICMS-ST, ja incluso o FCP caso incida sobre a mercadoria. Exemplo: aliquota da mercadoria na venda ao consumidor final = 18% e 2% de FCP. A aliquota a ser informada no campo pST deve ser 20%.',
	`pCREDSN` DECIMAL(15,2) NULL DEFAULT NULL COMMENT 'Aliquota do simples nacional',
	`vCREDICMSSN` DECIMAL(15,2) NULL DEFAULT NULL COMMENT 'Valor ICMS do simples nacional',
	`BASE_IPI` DECIMAL(15,2) NULL DEFAULT '0.00',
	`ALIQUOTA_IPI` DECIMAL(15,2) NULL DEFAULT '0.00',
	`CST_IPI` INT(11) NULL DEFAULT '0',
	`ID_ALIQUOTA` INT(11) NULL DEFAULT '0' COMMENT 'Armazena o codigo da aliquota em que o produto foi vendido',
	`UTRIB` VARCHAR(5) NULL DEFAULT NULL COMMENT 'Unidade tributavel' COLLATE 'latin1_swedish_ci',
	`QTRIB` DECIMAL(15,4) NULL DEFAULT NULL COMMENT 'Qtd tributavel',
	`VUNTRIB` DOUBLE NULL DEFAULT '0' COMMENT 'Vlr un. tributavel',
	`DISPENSAESTORNOCREDITO` CHAR(1) NOT NULL DEFAULT 'N' COMMENT 'Esse campo define como será feito o cálculo de ICMSST com Redução ST' COLLATE 'latin1_swedish_ci',
	`ACRESCIMO_PROMOCIONAL_PL_PGTO` DECIMAL(15,3) NULL DEFAULT NULL COMMENT 'Define o acrescimo para itens promocionais, de acordo com o  plano de pagamento ',
	`ACRESCIMO_PL_PGTO` DECIMAL(15,3) NULL DEFAULT NULL COMMENT 'Define o acrescimo para os itens, de acordo com o  plano de pagamento ',
	`VICMSDESON` DECIMAL(15,2) NULL DEFAULT '0.00' COMMENT 'Abatimento nao tributado e nao comercial Ex. desconto ICMS nas remessas para ZFM',
	`MOTDESICMS` INT(11) NULL DEFAULT '0' COMMENT 'Motivo abatimento nao tributado e nao comercial Ex. desconto ICMS nas remessas para ZFM',
	`COD_BENEFICIO` VARCHAR(10) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`ICMSSUBSTITUTO` DECIMAL(15,2) NOT NULL DEFAULT '0.00' COMMENT 'Valor do ICMS Proprio do Substituto cobrado em operacao anterior  (NT 2018.005)',
	`PEDIDOCLIENTE` VARCHAR(20) NULL DEFAULT NULL COMMENT 'Numero do pedido' COLLATE 'latin1_swedish_ci',
	`ITEMPEDIDOCLIENTE` INT(11) NULL DEFAULT NULL COMMENT 'Item do pedido',
	`ID_PEDIDO_ECOMMERCE` VARCHAR(30) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DESPESAS_BOLETO` DECIMAL(15,2) NOT NULL DEFAULT '0.00',
	`QTD_ENTREGUE` DECIMAL(15,3) NOT NULL DEFAULT '0.000' COMMENT 'Quantidade do produto j? entregue por um pedido de entrega parcial',
	`ID_TINTOMETRIA` INT(11) NULL DEFAULT NULL COMMENT 'Id da dosagem realizada no sistema tintometrico',
	`FORMULA_TINTOMETRIA` VARCHAR(100) NULL DEFAULT NULL COMMENT 'Formula no formato do sistema tintometrico' COLLATE 'latin1_swedish_ci',
	`ID_PRODUCAO` INT(11) NOT NULL DEFAULT '0' COMMENT 'ID da formula produzida ao aprovar',
	`ID_PLANOCONTA_ITEM` INT(11) NULL DEFAULT NULL,
	PRIMARY KEY (`PRIMARIA`) USING BTREE,
	INDEX `IDX_EMPRESA_VENDA` (`EMPRESA`, `VENDA`) USING BTREE,
	INDEX `IDX_IDPRODUTO` (`ID_PRODUTO`) USING BTREE,
	INDEX `IDX_IDTONALIDADE` (`ID_TONALIDADE`) USING BTREE,
	INDEX `IDX_ID_DAV` (`ID_DAV`) USING BTREE,
	INDEX `FK_produtos_prevenda_4` (`ID_PLANOCONTA_ITEM`) USING BTREE,
	CONSTRAINT `FK_ProdutosPrevenda_1` FOREIGN KEY (`EMPRESA`, `VENDA`) REFERENCES `prevenda` (`EMPRESA`, `VENDA`) ON UPDATE RESTRICT ON DELETE CASCADE,
	CONSTRAINT `FK_ProdutosPrevenda_2` FOREIGN KEY (`ID_PRODUTO`) REFERENCES `produtos` (`CODITEM`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_ProdutosPrevenda_3` FOREIGN KEY (`ID_TONALIDADE`) REFERENCES `tonalidades` (`ID_TONALIDADE`) ON UPDATE CASCADE ON DELETE RESTRICT,
	CONSTRAINT `FK_produtos_prevenda_4` FOREIGN KEY (`ID_PLANOCONTA_ITEM`) REFERENCES `plancontas` (`ID`) ON UPDATE CASCADE ON DELETE RESTRICT
)
COLLATE='latin1_swedish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=401
;



CREATE TABLE `perfilclientes` (
	`ID_PERFIL` INT(11) NOT NULL DEFAULT '0',
	`ID_EMPRESA` INT(11) NOT NULL DEFAULT '0',
	`DESCRICAO` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DESCONTO` DECIMAL(15,2) NULL DEFAULT NULL,
	`ACRESCIMO` DECIMAL(15,2) NULL DEFAULT NULL,
	`ACRESCIMOCUSTO` DECIMAL(15,2) NULL DEFAULT NULL,
	`OBSERVACAO` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	PRIMARY KEY (`ID_PERFIL`) USING BTREE,
	INDEX `IDX_IDEMPRESA` (`ID_EMPRESA`) USING BTREE,
	CONSTRAINT `FK_PerfilClientes_1` FOREIGN KEY (`ID_EMPRESA`) REFERENCES `empresas` (`CODIGO_N`) ON UPDATE CASCADE ON DELETE RESTRICT
)
COLLATE='latin1_swedish_ci'
ENGINE=InnoDB
;

INSERT INTO `perfilclientes` (`ID_PERFIL`, `ID_EMPRESA`, `DESCRICAO`, `DESCONTO`, `ACRESCIMO`, `ACRESCIMOCUSTO`, `OBSERVACAO`) VALUES (1, 1, 'ATACADO', 0.00, 0.00, 0.00, 'atacado');
INSERT INTO `perfilclientes` (`ID_PERFIL`, `ID_EMPRESA`, `DESCRICAO`, `DESCONTO`, `ACRESCIMO`, `ACRESCIMOCUSTO`, `OBSERVACAO`) VALUES (2, 1, 'REVENDA', 0.00, 0.00, 0.00, 'revenda');
INSERT INTO `perfilclientes` (`ID_PERFIL`, `ID_EMPRESA`, `DESCRICAO`, `DESCONTO`, `ACRESCIMO`, `ACRESCIMOCUSTO`, `OBSERVACAO`) VALUES (3, 1, 'CONSUMIDOR FINAL - (UNITARIO)', 0.00, 0.00, 0.00, 'unitario');
INSERT INTO `perfilclientes` (`ID_PERFIL`, `ID_EMPRESA`, `DESCRICAO`, `DESCONTO`, `ACRESCIMO`, `ACRESCIMOCUSTO`, `OBSERVACAO`) VALUES (4, 1, 'OUTROS - (PROMOÇÃO)', 0.00, 0.00, 0.00, 'promocao');


CREATE TABLE `carrinho_ecommerce` (
	`ID` INT(11) NOT NULL AUTO_INCREMENT,
	`ID_CLIENTE` INT(11) NULL DEFAULT NULL,
	`NOME` VARCHAR(50) NOT NULL DEFAULT '0' COLLATE 'latin1_swedish_ci',
	`TOTAL` DECIMAL(15,2) NULL DEFAULT '0.00',
	`STATUS` CHAR(1) NULL DEFAULT 'A' COLLATE 'latin1_swedish_ci',
	`FORMAPGTO` INT(11) NULL DEFAULT NULL,
	`NOME_FORMA` CHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	PRIMARY KEY (`ID`) USING BTREE
)
COLLATE='latin1_swedish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=15
;


CREATE TABLE `itens_carrinho_ecommerce` (
	`id` INT(11) NOT NULL AUTO_INCREMENT,
	`ID_CARRINHO_ECOMMERCE` INT(11) NULL DEFAULT NULL,
	`CODBARRA` CHAR(14) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`DESCRICAO` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`UNIDADE` CHAR(2) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci',
	`QTDE` DECIMAL(15,3) NULL DEFAULT NULL,
	`UNITARIO` DECIMAL(15,3) NULL DEFAULT NULL,
	`TOTAL` DECIMAL(15,3) NULL DEFAULT NULL,
	`ALIQUOTA` INT(11) NULL DEFAULT NULL,
	`CUSTO` DECIMAL(15,3) NULL DEFAULT NULL,
	`ID_PRODUTO` INT(11) NULL DEFAULT NULL,
	PRIMARY KEY (`id`) USING BTREE
)
COLLATE='latin1_swedish_ci'
ENGINE=InnoDB
AUTO_INCREMENT=23
;


UPDATE indices i 
SET i.TIPOPEDIDODEFAULT = 10,
i.TIPOPLANOPGDEFAULT = 1,
i.ID_PLANOCONTAPEDIDO = 1,
i.ID_BANCOPEDIDO = 1,
i.DEFAULTRETIRADOPOR = 'O PROPRIO';


UPDATE produto p 
SET p.INICIOPROMOCAO = '2023-01-01',
p.VALIDADE_PROMOCAO = '2023-01-01'
WHERE p.INICIOPROMOCAO IS NULL AND p.VALIDADE_PROMOCAO IS NULL;


ALTER TABLE `perfilclientes`
	ADD COLUMN `OBSERVACAO` VARCHAR(50) NULL DEFAULT NULL COLLATE 'latin1_swedish_ci' AFTER `ACRESCIMOCUSTO`;

ALTER TABLE `produtos_ecommerce`
	CHANGE COLUMN `OBSERVACOES` `OBSERVACOES` TEXT NULL COLLATE 'latin1_general_ci' AFTER `ENVIADO_SERVIDOR`;

